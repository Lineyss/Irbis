{% extends 'main/base.html' %}

{% block title %}

    {{title}}

{% endblock %}

{% block main %}

    <button onclick="buttonClick()">К категории</button>
    
    {% if detailView %}

        <div style="display: flex; margin: 20px 0; ">
            <h2>{{ module }}</h2>
            <button style="margin-left: 20px;">
                <a  href="{% url 'update_view' name=title pk=pk%}" 
                    style="text-decoration: none; color: black;">
                    Обновить        
                </a>
            </button>
        </div>

        {% if title == 'Платы' %}

            {% include 'components/pbc_view.html' %}

        {% else %}
        
            {% include 'components/module_view.html' %}

        {% endif %}

    {% else %}

        {{ form.errors }}

        <div style="display: flex; justify-content: space-evenly; align-items: center;">
            <form method="post" enctype='multipart/form-data'>
                {% csrf_token %}
                
                {{ form.as_p }}
                
                <button type="submit">Сохранить</button>
                <!-- <button type="submit">Удалить</button> -->
            </form>

            <img id="Image" src="" style="max-width: 500px; max-height: 500px;"/>
        </div>


        <script>
            let img = document.getElementById('Image')
            let label = document.querySelector("[for='id_Photo']");
            let p = label.parentElement
            let a = p.children[1]

            img.src = a.href
        </script>

    {% endif %}

    <script>
        function buttonClick()
        {
            let arrUrl = window.location.href.split('/')

            if(arrUrl[3] == 'create')
            {
                window.location.href = window.location.origin + '/category/' + arrUrl[5]
                return;
            }

            window.location.href = window.location.origin + '/category/' + arrUrl[4]
        }
    </script>

{% endblock %}